/* His name was Bruce McNair. Copyright 2025 City of Vernonia, Oregon. */
import{__awaiter as e}from"tslib";import r from"@arcgis/core/layers/CSVLayer";import o from"@arcgis/core/layers/GeoJSONLayer";import t from"@arcgis/core/layers/GroupLayer";const n=r=>e(void 0,void 0,void 0,function*(){return yield(yield fetch(r,{cache:"reload"})).json()});export let APPLICATION_GRAPHICS_LAYER=null;export let APPLICATION_MEASURE_LAYER=null;export let APPLICATION_SKETCH_LAYER=null;export const applicationGraphicsLayer=e=>{if(APPLICATION_GRAPHICS_LAYER||!e.map)return;const r=e.map.layers;return APPLICATION_MEASURE_LAYER=new t({listMode:"hide"}),APPLICATION_SKETCH_LAYER=new t({listMode:"hide"}),APPLICATION_GRAPHICS_LAYER=new t({listMode:"hide",layers:[APPLICATION_SKETCH_LAYER,APPLICATION_MEASURE_LAYER]}),r.add(APPLICATION_GRAPHICS_LAYER),r.on("after-add",()=>{r.reorder(APPLICATION_GRAPHICS_LAYER,r.length-1)}),APPLICATION_GRAPHICS_LAYER};export const csvLayerFromJSON=(o,t)=>e(void 0,void 0,void 0,function*(){try{const e=Object.assign(Object.assign(Object.assign({},yield n(o)),{customParameters:{d:(new Date).getTime()}}),t||{});return new r(e)}catch(e){return console.log(e),new r}});export const geojsonLayerFromJSON=(r,t)=>e(void 0,void 0,void 0,function*(){try{const e=Object.assign(Object.assign(Object.assign({},yield n(r)),{customParameters:{d:(new Date).getTime()}}),t||{});return new o(e)}catch(e){return console.log(e),new o}});export const mapImageNoPopups=r=>e(void 0,void 0,void 0,function*(){var e;yield r.when(),null===(e=r.sublayers)||void 0===e||e.forEach(e=>{e.popupEnabled=!1})});export const queryFeatureGeometry=r=>e(void 0,void 0,void 0,function*(){const{layer:e,layer:{objectIdField:o},graphic:t,outSpatialReference:n}=r;try{return(yield e.queryFeatures({where:`${o} = ${t.attributes[o]}`,returnGeometry:!0,outSpatialReference:n||e.spatialReference})).features[0].geometry}catch(e){console.log(e)}});