/* His name was Bruce McNair. Copyright 2025 City of Vernonia, Oregon. */
import{__awaiter as e}from"tslib";import o from"@arcgis/core/layers/CSVLayer";import r from"@arcgis/core/layers/GeoJSONLayer";import t from"@arcgis/core/layers/GroupLayer";const i=o=>e(void 0,void 0,void 0,(function*(){return yield(yield fetch(o,{cache:"reload"})).json()}));export let APPLICATION_GRAPHICS_LAYER=null;export const applicationGraphicsLayer=o=>e(void 0,void 0,void 0,(function*(){if(yield o.when(),APPLICATION_GRAPHICS_LAYER)return;const e=o.map.layers;APPLICATION_GRAPHICS_LAYER=new t({listMode:"hide"}),e.add(APPLICATION_GRAPHICS_LAYER),e.on("after-add",(()=>{e.reorder(APPLICATION_GRAPHICS_LAYER,e.length-1)}))}));export const csvLayerFromJSON=(r,t)=>e(void 0,void 0,void 0,(function*(){try{const e=Object.assign(Object.assign(Object.assign({},yield i(r)),{customParameters:{d:(new Date).getTime()}}),t||{});return new o(e)}catch(e){return console.log(e),new o}}));export const geojsonLayerFromJSON=(o,t)=>e(void 0,void 0,void 0,(function*(){try{const e=Object.assign(Object.assign(Object.assign({},yield i(o)),{customParameters:{d:(new Date).getTime()}}),t||{});return new r(e)}catch(e){return console.log(e),new r}}));export const mapImageNoPopups=o=>e(void 0,void 0,void 0,(function*(){var e;yield o.when(),null===(e=o.sublayers)||void 0===e||e.forEach((e=>{e.popupEnabled=!1}))}));export const queryFeatureGeometry=o=>e(void 0,void 0,void 0,(function*(){const{layer:e,layer:{objectIdField:r},graphic:t,outSpatialReference:i}=o;try{return(yield e.queryFeatures({where:`${r} = ${t.attributes[r]}`,returnGeometry:!0,outSpatialReference:i||e.spatialReference})).features[0].geometry}catch(e){console.log(e)}}));