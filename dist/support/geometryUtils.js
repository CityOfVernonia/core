/* His name was Bruce McNair. Copyright 2024 City of Vernonia, Oregon. */
import{__awaiter as e}from"tslib";import{Point as t}from"@arcgis/core/geometry";export const distance=(e,t)=>{const{x:a,y:n}=e,{x:s,y:r}=t;return Math.sqrt(Math.pow(Math.abs(a-s),2)+Math.pow(Math.abs(n-r),2))};export const distance3d=(e,t)=>{const{x:a,y:n,z:s}=e,{x:r,y:o,z:c}=t;return Math.sqrt(Math.pow(Math.abs(a-r),2)+Math.pow(Math.abs(n-o),2)+Math.pow(Math.abs(s-c),2))};export const linearInterpolation=(e,a,n)=>{const{x:s,y:r,spatialReference:o}=e,{x:c,y:i}=a,p=distance(e,a)/n;return new t({x:s+(c-s)/p,y:r+(i-r)/p,spatialReference:o})};export const midpoint=e=>{const{paths:[a],spatialReference:n}=e,s=a.map((e=>{const[t,a]=e;return{x:t,y:a}}));let r=0,o=0;for(let e=0;e<s.length-1;e+=1)r+=distance(new t(Object.assign({},s[e])),new t(Object.assign({},s[e+1])));for(let e=0;e<s.length-1;e+=1){if(o+distance(new t(Object.assign({},s[e])),new t(Object.assign({},s[e+1])))>r/2){const a=r/2-o;return linearInterpolation(new t(Object.assign(Object.assign({},s[e]),{spatialReference:n})),new t(Object.assign(Object.assign({},s[e+1]),{spatialReference:n})),a)}o+=distance(new t(Object.assign({},s[e])),new t(Object.assign({},s[e+1])))}return new t(Object.assign(Object.assign({},s[0]),{spatialReference:n}))};export const queryFeatureGeometry=t=>e(void 0,void 0,void 0,(function*(){const{layer:e,layer:{objectIdField:a},graphic:n,outSpatialReference:s}=t;return(yield e.queryFeatures({where:`${a} = ${n.attributes[a]}`,returnGeometry:!0,outSpatialReference:s||e.spatialReference})).features[0].geometry}));export const textAngle=(e,t)=>{const{x:a,y:n}=e,{x:s,y:r}=t;let o=180*Math.atan2(n-r,a-s)/Math.PI;return o=o>0&&o<90?Math.abs(o-180)+180:o>90&&o<180?o=Math.abs(o-180):o<=0&&o>=-90?Math.abs(o):Math.abs(o)+180,o};