/* His name was Bruce McNair. Copyright 2023 City of Vernonia, Oregon. */
import{__awaiter as t,__decorate as o}from"tslib";import{subclass as e,property as i}from"@arcgis/core/core/accessorSupport/decorators";import l from"@arcgis/core/widgets/Widget";import{tsx as n}from"@arcgis/core/widgets/support/widget";const d=new RegExp(/https:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/);let a=class extends l{constructor(t){super(t),this.container=document.createElement("calcite-modal"),this.showDownload=!0,this._fileName="",this._url="",this._loading=!1,document.body.append(this.container),this.container.addEventListener("calciteModalClose",(()=>{this._url=""}))}download(o,e){return t(this,void 0,void 0,(function*(){let t=e;if(e.match(d)){const o=yield(yield fetch(e)).blob();t=URL.createObjectURL(o)}const i=Object.assign(document.createElement("a"),{href:t,download:o,style:"display: none;"});document.body.append(i),i.click(),document.body.removeChild(i)}))}show(t,o){this._fileName=t,this._url!==o&&(this._loading=!0),this._url=o,this.container.open=!0}_close(){this.container.open=!1}render(){const{showDownload:t,_fileName:o,_url:e,_loading:i}=this;return n("calcite-modal",{style:"--calcite-modal-content-padding: 0;"},n("div",{slot:"header"},o),n("div",{slot:"content"},n("calcite-scrim",{hidden:!i,loading:""}),n("img",{style:"width: 100%; min-height: 300px;",src:e,afterCreate:t=>{t.addEventListener("load",(()=>{this._loading=!1}))}})),t?n("calcite-button",{appearance:"outline",slot:"secondary",width:"full",onclick:this.download.bind(this,o,e)},"Download"):null,n("calcite-button",{slot:"primary",width:"full",onclick:this._close.bind(this)},"Close"))}};o([i()],a.prototype,"_fileName",void 0),o([i()],a.prototype,"_url",void 0),o([i()],a.prototype,"_loading",void 0),a=o([e("cov.modals.PhotoModal")],a);export default a;