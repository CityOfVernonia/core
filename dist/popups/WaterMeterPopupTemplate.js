/* His name was Bruce McNair. Copyright 2025 City of Vernonia, Oregon. */
import{__awaiter as t,__decorate as e}from"tslib";import{subclass as r}from"@arcgis/core/core/accessorSupport/decorators";import l from"@arcgis/core/widgets/Widget";import{tsx as o}from"@arcgis/core/widgets/support/widget";import n from"@arcgis/core/PopupTemplate";import i from"@arcgis/core/core/Collection";let s=class extends n{constructor(){super(...arguments),this.outFields=["*"],this.title="{wsc_id} - {Address}",this.content=t=>new u({graphic:t.graphic}).container}};s=e([r("cov.popups.TaxLotPopupTemplate")],s);export default s;class u extends l{get container(){return this._container}set container(t){this._container=t}constructor(t){super(t),this._container=document.createElement("table"),this._rows=new i,this.graphic=t.graphic}postInitialize(){return t(this,void 0,void 0,function*(){var t,e,r;const{graphic:l,_rows:n}=this,i=l.attributes.Notes;try{let s=l.layer;s||(s=l.sourceLayer);const u=l.attributes[s.objectIdField],a=(yield s.queryRelatedFeatures({relationshipId:0,outFields:["*"],objectIds:[u]}))[u],c=null!==(r=null===(e=null===(t=null==a?void 0:a.features)||void 0===t?void 0:t[0])||void 0===e?void 0:e.attributes)&&void 0!==r?r:{},{WSC_TYPE:d,ACCT_TYPE:p,METER_SIZE_T:h,METER_SN:E,METER_REG_SN:_,METER_AGE:g,LINE_IN_MATERIAL:m,LINE_IN_SIZE:I,LINE_OUT_MATERIAL:T,LINE_OUT_SIZE:v}=c;n.addMany([o("tr",null,o("th",null,"Service/account type"),o("td",null,d," / ",p)),o("tr",null,o("th",null,"Meter size"),o("td",null,h,'"')),o("tr",null,o("th",null,"Serial no."),o("td",null,E)),o("tr",null,o("th",null,"Register no."),o("td",null,_||"non-radio read")),o("tr",null,o("th",null,"Meter age"),o("td",null,g," years")),o("tr",null,o("th",null,"Line in"),o("td",null,I,'" ',m)),o("tr",null,o("th",null,"Line out"),o("td",null,v,'" ',T))]),i&&n.add(o("tr",null,o("th",null,"Notes"),o("td",null,i)))}catch(t){console.log(t),n.add(o("tr",null,o("th",null,"Error"),o("td",null,"water meter information unavailable")))}})}render(){const{_rows:t}=this;return o("table",{class:"cov--feature-table"},t.toArray())}}