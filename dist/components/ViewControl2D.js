/* His name was Bruce McNair. Copyright 2025 City of Vernonia, Oregon. */
import{__awaiter as e,__decorate as i}from"tslib";import{watch as t}from"@arcgis/core/core/reactiveUtils";import{property as o,subclass as n}from"@arcgis/core/core/accessorSupport/decorators";import c from"@arcgis/core/widgets/Widget";import{tsx as a}from"@arcgis/core/widgets/support/widget";import s from"@arcgis/core/widgets/Home/HomeViewModel";import l from"@arcgis/core/widgets/Zoom/ZoomViewModel";import{referenceElement as r}from"./support";const d="cov--view-control-2d",m={base:d,actions:`${d}_actions`};let f=class extends c{constructor(e){super(e),this.includeFullscreen=!1,this.includeLocate=!1,this.includeMagnifier=!1,this._fullscreen=!1}postInitialize(){const{magnifierProperties:e,view:i,view:{magnifier:t}}=this;this._home=new s({view:i}),this._zoom=new l({view:i}),document.fullscreenElement&&(this._fullscreen=!0),t.visible=!1,e&&Object.assign(t,e)}_compassRotation(e){const{view:i}=this;let t;e.shadowRoot?(t=e.shadowRoot.querySelector(".icon-container"),t?(t.style.transform=`rotate(${i.rotation}deg)`,this.watch("view.rotation",()=>{t.style.transform=`rotate(${i.rotation}deg)`})):setTimeout(()=>{this._compassRotation(e)},100)):setTimeout(()=>{this._compassRotation(e)},100)}_initializeFullscreen(e){document.body.requestFullscreen?(e.addEventListener("click",()=>{const{_fullscreen:e}=this;e?document.exitFullscreen():document.body.requestFullscreen()}),document.addEventListener("fullscreenchange",()=>{this._fullscreen=!!document.fullscreenElement})):e.disabled=!0}_initializeLocate(i){return e(this,void 0,void 0,function*(){const{view:e,locateProperties:o}=this,n=new((yield import("@arcgis/core/widgets/Locate/LocateViewModel")).default)(Object.assign({view:e},o));i.addEventListener("click",n.locate.bind(n)),i.disabled="disabled"===n.state,this.addHandles(t(()=>n.state,e=>{i.disabled="disabled"===e,i.icon="ready"===n.state?"gps-on":"locating"===n.state?"gps-on-f":"disabled"===n.state?"gps-off":""}))})}_toggleMagnifier(){const{view:e,view:{magnifier:i},_magnifierHandle:t}=this;i.visible?(i.visible=!1,t&&t.remove()):(i.visible=!0,this._magnifierHandle=e.on("pointer-move",e=>{i.position={x:e.x,y:e.y}}))}render(){const{view:e,_zoom:i,_fullscreen:t,_home:o,includeLocate:n,includeFullscreen:c,includeMagnifier:s}=this,l=e.magnifier.visible,d=t?"Exit fullscreen":"Enter fullscreen",f=t?"full-screen-exit":"extent";return a("div",{class:m.base},a("div",{class:m.actions},a("calcite-action-bar",{"expand-disabled":"",floating:!0},a("calcite-action-group",null,a("calcite-action",{text:"Zoom in",icon:"plus",scale:"s",disabled:!i.canZoomIn,onclick:i.zoomIn.bind(i)}),a("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:r.bind(this)},"Zoom in"),a("calcite-action",{text:"Zoom out",icon:"minus",scale:"s",disabled:!i.canZoomOut,onclick:i.zoomOut.bind(i)}),a("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:r.bind(this)},"Zoom out"))),a("calcite-action-bar",{"expand-disabled":"",floating:!0},a("calcite-action-group",null,a("calcite-action",{text:"Default extent",icon:"home",scale:"s",onclick:o.go.bind(o)}),a("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:r.bind(this)},"Default extent"),n?[a("calcite-action",{text:"Zoom to location",icon:"gps-on",scale:"s",disabled:"",afterCreate:this._initializeLocate.bind(this)}),a("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:r.bind(this)},"Zoom to location")]:null,e.constraints.rotationEnabled?[a("calcite-action",{text:"Reset orientation",icon:"compass-needle",scale:"s",afterCreate:this._compassRotation.bind(this),onclick:()=>e.rotation=0}),a("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:r.bind(this)},"Reset orientation")]:null)),c?a("calcite-action-bar",{"expand-disabled":"",floating:!0},a("calcite-action-group",null,a("calcite-action",{text:d,disabled:"",scale:"s",icon:f,afterCreate:this._initializeFullscreen.bind(this)}),a("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:r.bind(this)},d))):null,s?a("calcite-action-bar",{"expand-disabled":"",floating:!0},a("calcite-action-group",null,a("calcite-action",{text:l?"Hide magnifier":"Show magnifier",scale:"s",icon:"magnifying-glass",indicator:!!l,onclick:this._toggleMagnifier.bind(this)}),a("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:r.bind(this)},l?"Hide magnifier":"Show magnifier"))):null))}};i([o()],f.prototype,"_fullscreen",void 0),f=i([n("cov.components.ViewControl2D")],f);export default f;