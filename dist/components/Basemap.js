/* His name was Bruce McNair. Copyright 2025 City of Vernonia, Oregon. */
import{__awaiter as i,__decorate as e}from"tslib";import{property as t,subclass as a}from"@arcgis/core/core/accessorSupport/decorators";import s from"@arcgis/core/widgets/Widget";import{tsx as r}from"@arcgis/core/widgets/support/widget";import{subscribe as o}from"pubsub-js";const l="cov--basemap",m={base:l,image:`${l}_image`};export const IMAGERY_LAYER_TOPIC="basemap-imagery-layer-topic";export const IMAGERY_REFERENCE_LAYER_TOPIC="basemap-imagery-reference-layer-topic";let n=class extends s{get container(){return this._container}set container(i){this._container=i}constructor(i){super(i),this._hillshadeThumbnail="",this._imageryThumbnail=""}postInitialize(){return i(this,void 0,void 0,function*(){const{hillshade:i,imagery:e}=this;i.thumbnailUrl?this._hillshadeThumbnail=i.thumbnailUrl:(yield i.load(),this._hillshadeThumbnail=i.thumbnailUrl||""),e.thumbnailUrl?this._imageryThumbnail=e.thumbnailUrl:(yield e.load(),this._imageryThumbnail=e.thumbnailUrl||"");const t=e.baseLayers.getItemAt(0);t&&(this._default=t),o(IMAGERY_LAYER_TOPIC,(i,e)=>{"default"===e?this.imageryLayer(this._default):this.imageryLayer(e)}),o(IMAGERY_REFERENCE_LAYER_TOPIC,(i,e)=>{this.imageryReferenceVisibility(e)})})}imageryLayer(i){const{imagery:e,imagery:{baseLayers:t},_basemap:a}=this;t.splice(0,1,i),a!==e&&(this._basemap=e)}imageryReferenceVisibility(i){const{imagery:e,imagery:{baseLayers:t},_basemap:a}=this,s=t.getItemAt(t.length-1);s&&(s.visible=i),a!==e&&(this._basemap=e)}_info(){const{hillshade:i,_basemap:e,_hillshadeThumbnail:t,_imageryThumbnail:a}=this,s=e===i;return{tooltip:s?"Imagery":"Map",url:s?a:t}}_toggle(){const{hillshade:i,imagery:e,_basemap:t}=this;this._basemap=t===i?e:i}_tooltip(i){i.referenceElement=this.container}render(){const{tooltip:i,url:e}=this._info();return r("div",{class:m.base},r("div",{class:m.image,style:`background-image: url(${e})`,onclick:this._toggle.bind(this)}),r("calcite-tooltip",{"close-on-click":"","overlay-positioning":"fixed",afterCreate:this._tooltip.bind(this)},i))}};e([t({aliasOf:"view.map.basemap"})],n.prototype,"_basemap",void 0),e([t()],n.prototype,"_hillshadeThumbnail",void 0),e([t()],n.prototype,"_imageryThumbnail",void 0),n=e([a("cov.components.Basemap")],n);export default n;